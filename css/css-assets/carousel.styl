@import '../assets/imports.styl'

PX = (1/16)em

carouselTransitionTime = .3s
.carousel
	.no-preserve-3d &
		background url('i/carousel-fallback.png') no-repeat center center
		width  326*PX
		height 387*PX
		transform scale(1)
		right 5%
	.icon-banner
		transform scale(0)
	.carousel--3d
		transform rotateY(-180deg)
	.cylinder-1
		height 0
		.banner
			backface-visibility hidden
			transform scale(0) translateZ(2*PX)
	.carousel-middle
		width .75em
		margin-left - 3*PX
		transform translateY(400*PX) translateX(-2*PX) translateZ(22*PX) rotateY(-120deg)
	.carousel__sticks
		height 0
		position relative
		nw 0
		top 50%
		transform-style preserve-3d
		.cylinder-2
			opacity:1;
			width:.25em
			margin:-7.5em 0 0 -0.125em
			height 100%
			.side
				width:0.4580127018922192em
				backface-visibility visible
				height 100%
				background url('i/carousel-sticks-bg.png') repeat
				// background-color: #faf4e5
				// background-color: lighten(#9B2E2E, 15)

	width = 20*PX
	.carousel-bottom
		width width
		margin-left -(width/2)
		left 50%
	carouselAnimationTime  = 40s
	rotateTime = 6*carouselTransitionTime
	rotateEasing = linear
	&.is-open
		.carousel--3d
			animation rotateCarousel carouselAnimationTime rotateEasing infinite
			animation-fill-mode both
		.carousel-middle
			animation rotateCarouselMiddle carouselAnimationTime rotateEasing infinite
			animation-fill-mode both
		iconBannerAnimationTime = 4s
		.icon-banner
			animation iconBanner iconBannerAnimationTime ease infinite
			animation-fill-mode both
		.icon-banner--odd
			animation iconBanner2 iconBannerAnimationTime ease infinite
			animation-fill-mode both

.carousel-middle
	position absolute
	width 5em
	height 22em
	background-color #571313
	top 15em
	left 50%

.carousel-bottom
	position absolute
	// width 36em - 10*PX
	z-index 1
	height   2.5em
	bottom 	-4.75em
	// margin-left -2em
	background-color #dd5754
	transform translateZ(400*PX)

.carousel-bottom--top, .carousel-bottom--bottom
	width 101.5%
	margin-left -0.75%
	background-color #891b1b
	height .25em
	position absolute
	border-radius 2*PX

.carousel-bottom--bottom
	bottom 0

width = 90%
.carousel-bottom--bottom2
	position absolute
	width width
	left ((100% - width)/2)
	height .5em
	bottom -.5em
	background-color #9b2e2e

.carousel-bottom--bottom3
	position absolute
	height 1em + 2*PX
	width  7em
	left 50%
	margin-left -3.5em
	bottom -1.5em - 2*PX
	background-color #571313

.dome
	position absolute
	display inline-block
	width: 50*PX
	height: 370.5*PX
	transform-style preserve-3d
	transform-origin 50% top 0
	backface-visibility hidden
	&:nth-of-type(even)
		.dome__inner
			background url('i/dome-red.png') no-repeat center center
			background-size 100%
	&__inner
		rect 100%
		nw 0
		position absolute
		background url('i/dome-white.png') no-repeat center center
		background-size 100%
		transform-origin 50% top 0

.model
	position relative
	transform-style preserve-3d
	for i in 1..36
		.s{i}
			transform translate3d(-60*PX, 0, 0) rotateZ(i*10deg) scaleZ(1) rotateX(-90deg)//
			transform-origin 50% top 0

.carousel--scene
	transform perspective(200000*PX) rotateX(90deg) rotateZ(50deg) translateZ(250*PX)
	transform-origin 50% 50%
	margin-left -50%
	margin-top  -50%
	left 50%
	top 50%



.carousel
	position relative
	width  500*PX
	height 500*PX
	transform scale(.55)
	svg
		position absolute
		backface-visibility hidden
	

.carousel--3d, .carousel--scene, .carousel--stage
	transform-style:preserve-3d
	position:absolute
	width:100%
	height:100%

.carousel--stage
	left:57%
	top:50%
	opacity:1


width = 134*PX
height = 80*PX
.banner
	width width
	height height
	top -(height/2)
	left -(width/2) + (3.1581877625221533/2)em
	retina 'i/brands', 100%, transparent
	position absolute
	backface-visibility hidden
	transform translateZ(2*PX)
	&.is-celebrities
		retina 'i/celebrities', 100%, transparent
	&.is-interests
		retina 'i/interests', 100%, transparent
	&.is-tv-shows
		retina 'i/tv-shows', 100%, transparent

fontSize = 32*PX
.banner--text
	font-size fontSize
	padding-top 5*PX
	color white
	text-align center
	position relative
	z-index 1
	// outage()

size = 28*PX
.banner--circle
	position absolute
	top 50%
	left -(size/2)
	margin-top -(size/2)
	width  size
	height size
	background-color inherit
	border-radius    inherit

	size = 4*PX
	&:after
		content ''
		position absolute
		top 50%
		left 50%
		margin-left - (size/2)
		margin-top  - (size/2)
		width  size
		height size
		background-color white
.banner--circle-right
	right -(size/2)
	left auto

size = 5em
.icon-banner
	width  size
	height size
	margin-top  -(size/2)
	margin-left -(size/2)
	position absolute
	top 35%
	left 0
	background-color #faf4e5
	border-radius 50%
	backface-visibility visible
	transform-style preserve-3d
	.icon
		rect 50%
		left 25%
		top  25%
		position absolute
		transform translateZ(1px)

	&--odd
		top 65%

width = 2.5em
.carousel-top
	width  width
	height 5em
	position absolute
	top -5em
	left 50%
	margin-left -(width/2)
	
	.carousel-top--circle-large, .carousel-top--circle-small
		width width
		height width
		background-color #f6c855
		position absolute
		bottom 0
		border-radius 50%
		box-shadow inset 0 -6*PX 0 rgba(0,0,0,.15)

	.carousel-top--circle-small
		width  (width/1.75)
		height (width/1.75)
		bottom width + 6*PX
		box-shadow inset 0 -4*PX 0 rgba(0,0,0,.15)
		left 50%
		margin-left -((width/1.75)/2)

		&:after
			content ''
			position absolute
			width 6*PX
			height 2em
			background #d4b05c
			left 8*PX
			z-index -1

		&:before
			content ''
			position absolute
			border 4*PX solid rgba(#f6c855,0)
			border-bottom 2em solid #f6c855
			top - 36*PX
			left 8*PX
			z-index -1

.cylinder-1 
	.face
		background-color #dd5754 
		border-bottom-left-radius  40*PX
		border-bottom-right-radius 40*PX
		backface-visibility hidden
		&:nth-of-type(odd)
			background-color #e1d7be

		&:first-of-type
			background-color transparent

.scene, .shape, .face, .face-wrapper, .cr
	position: absolute;
	transform-style preserve-3d

.scene
	width: 80em;
	height: 80em;
	top: 50%;
	left: 57%;
	margin: -40em 0 0 -40em;
	transform rotateX(-90deg) rotateY(5deg) translate3d(-33px,234px,-22px)
	transform-origin 50% 50%

.shape
	top: 50%;
	left: 50%;
	width: 0;
	height: 0;
	transform-origin 50%

.face, .face-wrapper
	transform-origin 0 0
	backface-visibility hidden
	/* hidden by default, prevent blinking and other weird rendering glitchs */

.face-wrapper .face
	left: 100%;
	width: 100%;
	height: 100%

.side
	left: 50%

.cr, .cr .side
	height: 100%

/* .cyl-1 styles */
.cyl-1
	transform translate3d(-0.1875em, 2.0625em, 1.1875em) rotateX(0deg) rotateY(-.25deg) rotateZ(0deg);
	opacity:1;
	width:35.8125em;
	height:4em;
	margin: -2em 0 0 -17.90625em
	.side
		width:3.1581877625221533em
		height: 100%
	.bm
		width:35.8125em
		height:35.8125em
		border-radius: 50%
		transform: rotateX(-90deg) translateY(-50%)
		top: 65%

	start = 5
	for i in 1..37
		.s{i}
			transform rotateY((start+(i*10))deg) translate3d(-50%, 0, 17.88125em)

r = 0
xz = -11.091666666666663em, -9.958333333333334em, 0, -14em, 10.658333333333337em, -10.250000000000002em, 15.666666666666666em, 0.08333333333333333em, 11.450000000000003em, 10.895833333333334em, -11.070833333333331em, 11.979166666666666em, -16em, 0, 0, 16.583333333333332em
for i in 2..9
	if (i == 2)
		degree = -90deg
	if (i == 3)
		degree = 240deg
	if (i == 4)
		degree = 180deg
	if (i == 5)
		degree = 160deg
	if (i == 6)
		degree = 100deg
	if (i == 7)
		degree = 20deg
	if (i == 8)
		degree = -40deg
	if (i == 9)
		degree = 70deg
	.cyl-{i}
		transform translate3d(xz[r], 10.249999999999998em, xz[r+1]) rotateX(0deg) rotateY(degree) rotateZ(0deg);

		start = 60
		for j in 0..2
			.s{j}
				transform rotateY((start+(j*120))deg) translate3d(-50%, 0, 0.1em)
	
	r += 2
	


@keyframes iconBanner
	0%
		top 35%
	50%
		top 65%
	100%
		top 35%

@keyframes iconBanner2
	0%
		top 65%
	50%
		top 35%
	100%
		top 65%


@keyframes rotateCarousel
	0%
		transform rotateY(-180deg)
	100%
		transform rotateY(-540deg)

@keyframes rotateCarouselMiddle
	0%
		transform translateY(400*PX) translateX(-2px) translateZ(22px) rotateY(-120deg)
	100%
		transform translateY(400*PX) translateX(-2px) translateZ(22px) rotateY(240deg)
